---
import Badge from '../components/ui/Badge.astro';
import { useTranslations } from '../i18n/ui';

const t = useTranslations('es');

const steps = [
  {
    number: t('howItWorks.step1.number'),
    title: t('howItWorks.step1.title'),
    description: t('howItWorks.step1.description'),
  },
  {
    number: t('howItWorks.step2.number'),
    title: t('howItWorks.step2.title'),
    description: t('howItWorks.step2.description'),
  },
  {
    number: t('howItWorks.step3.number'),
    title: t('howItWorks.step3.title'),
    description: t('howItWorks.step3.description'),
  },
  {
    number: t('howItWorks.step4.number'),
    title: t('howItWorks.step4.title'),
    description: t('howItWorks.step4.description'),
  },
  {
    number: t('howItWorks.step5.number'),
    title: t('howItWorks.step5.title'),
    description: t('howItWorks.step5.description'),
  },
];
---

<section class="how-it-works section" id="como-funciona" data-animate="section">
  <div class="how-it-works__container container">
    <div class="how-it-works__header">
      <Badge text={t('howItWorks.badge')} />
      <h2 class="how-it-works__title">{t('howItWorks.title')}</h2>
      <p class="how-it-works__description">{t('howItWorks.description')}</p>
    </div>

    <div class="how-it-works__timeline">
      <div class="how-it-works__line" data-animate="progress-line" aria-hidden="true"></div>
      
      {steps.map((step, index) => (
        <div 
          class={`how-it-works__step ${index % 2 === 0 ? 'how-it-works__step--left' : 'how-it-works__step--right'}`}
          data-animate="step"
        >
          <div class="how-it-works__step-marker">
            <span class="how-it-works__step-number">{step.number}</span>
          </div>
          <div class="how-it-works__step-content">
            <h3 class="how-it-works__step-title">{step.title}</h3>
            <p class="how-it-works__step-description">{step.description}</p>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .how-it-works {
    background: var(--color-bg-primary);
    position: relative;
  }

  .how-it-works__container {
    display: flex;
    flex-direction: column;
    gap: var(--space-16);
  }

  .how-it-works__header {
    text-align: center;
    max-width: 600px;
    margin-inline: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-4);
  }

  .how-it-works__title {
    font-size: var(--text-4xl);
    font-weight: var(--font-bold);
    line-height: var(--leading-tight);
  }

  .how-it-works__description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
  }

  /* Timeline */
  .how-it-works__timeline {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: var(--space-8);
    padding-left: var(--space-12);
  }

  .how-it-works__line {
    position: absolute;
    left: 22px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: linear-gradient(
      180deg,
      var(--color-accent-cyan) 0%,
      var(--color-accent-purple) 100%
    );
    transform-origin: top center;
  }

  .how-it-works__step {
    display: flex;
    gap: var(--space-6);
    position: relative;
  }

  .how-it-works__step-marker {
    position: absolute;
    left: calc(-1 * var(--space-12) - 22px + 11px);
    top: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    background: var(--color-bg-primary);
    border: 2px solid var(--color-accent-cyan);
    border-radius: 50%;
    z-index: 1;
  }

  .how-it-works__step-number {
    font-size: var(--text-sm);
    font-weight: var(--font-bold);
    color: var(--color-accent-cyan);
    font-family: var(--font-sans);
  }

  .how-it-works__step-content {
    flex: 1;
    padding: var(--space-6);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    transition: all var(--duration-normal) var(--ease-out);
  }

  .how-it-works__step:hover .how-it-works__step-content {
    border-color: var(--color-accent-cyan);
    box-shadow: var(--glow-cyan);
  }

  .how-it-works__step:hover .how-it-works__step-marker {
    background: var(--color-accent-cyan);
  }

  .how-it-works__step:hover .how-it-works__step-number {
    color: var(--color-bg-primary);
  }

  .how-it-works__step-title {
    font-size: var(--text-xl);
    font-weight: var(--font-semibold);
    color: var(--color-text-primary);
    margin-bottom: var(--space-2);
  }

  .how-it-works__step-description {
    font-size: var(--text-base);
    color: var(--color-text-tertiary);
    line-height: var(--leading-relaxed);
  }

  @media (min-width: 768px) {
    .how-it-works__timeline {
      padding-left: 0;
      padding-right: 0;
    }

    .how-it-works__line {
      left: 50%;
      transform: translateX(-50%);
    }

    .how-it-works__step {
      width: 50%;
      padding-right: var(--space-12);
    }

    .how-it-works__step--left {
      align-self: flex-start;
    }

    .how-it-works__step--right {
      align-self: flex-end;
      padding-right: 0;
      padding-left: var(--space-12);
    }

    .how-it-works__step--left .how-it-works__step-marker {
      left: auto;
      right: calc(-1 * var(--space-12) - 22px);
    }

    .how-it-works__step--right .how-it-works__step-marker {
      left: calc(-1 * var(--space-12) - 22px);
    }
  }

  @media (min-width: 1024px) {
    .how-it-works__step {
      width: 45%;
    }
  }
</style>
